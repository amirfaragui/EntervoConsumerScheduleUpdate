@using Entrvo.DAL;

@(
Html.Kendo().Grid<Email>()
    .Name("emailsGrid")
    .Columns(columns =>
    {
      columns.Bound(model => model.EffectiveRank).Width(100).EditorTemplateName("Integer");
      columns.Bound(model => model.EmailAddress).Width(150);
      columns.Bound(model => model.StartDate).Width(120).Format("{0:yyyy/MM/dd}");
      columns.Bound(model => model.EndDate).Width(120).Format("{0:yyyy/MM/dd}");
      columns.Bound(model => model.Priority).Width(100).EditorTemplateName("Integer");

      columns.Command(command =>
      {
        command.Edit();
        command.Destroy();
      }).Width(80);
    })
    .ToolBar(toolbar =>
    {
      toolbar.Create();
      toolbar.Separator();
      toolbar.Search();
    })
    .Pageable(p =>
    {
      p.Refresh(true);
      p.PageSizes(new int[] { 100, 500 });
    })
    .Scrollable(scrollable => scrollable.Enabled(true).Height("calc(100vh - 450px)").Virtual(true))
    .Selectable(selectable => selectable.Mode(GridSelectionMode.Single))
    .DataSource(datasource => datasource
    .Ajax().PageSize(100)
      .Model(model =>
      {
        model.Id(o => o.EmailAddressUID);
        model.Field(o => o.CustomerUID).DefaultValue(ViewData["CustomerUID"]);
        model.Field(o => o.EffectiveRank).DefaultValue(1);
        model.Field(o => o.Priority).DefaultValue(1);
      })
      .Sort(sort => sort.Add(m => m.EffectiveRank).Ascending())
      .Read(read => read.Action("_read", "emails").Data("getCustomerId"))
      .Update(update => update.Action("_update", "emails"))
      .Destroy(destroy => destroy.Action("_destroy", "emails"))
      .Create(create => create.Action("_create", "emails").Data("getCustomerId"))
    )
    .Resizable(resize => resize.Columns(true))
    .Sortable(sort => sort.SortMode(GridSortMode.SingleColumn))
    .Search(search => search
      .Field(m => m.EmailAddress)
    )
)

@section Scripts {
  <script type="text/javascript">

  </script>
}