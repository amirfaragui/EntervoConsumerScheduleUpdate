/**
 * Kendo UI v2024.3.1015 (http://www.telerik.com/kendo-ui)
 * Copyright 2024 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("kendo.core.js"),require("kendo.draganddrop.js"),require("kendo.chip.js"),require("kendo.chiplist.js"),require("kendo.icons.js")):"function"==typeof define&&define.amd?define(["kendo.core.min","kendo.draganddrop.min","kendo.chip.min","kendo.chiplist.min","kendo.icons.min"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).kendogroupable=e.kendogroupable||{},e.kendogroupable.js=t())}(this,(function(){return function(e,t){var n=window.kendo,r=n.ui.Widget,i=n._outerWidth,a=n.attr,o=e.extend,s=e.each,d=!1,l="asc",c="group-sort",g="k-grouping-drop-container",u=function(t){var r=t.attr(n.attr("title"));return r&&(r=n.htmlEncode(r)),e('<div class="k-group-clue k-drag-clue" />').html(r||n.htmlEncode(t.attr(n.attr("field")))).prepend(n.ui.icon({icon:"cancel",iconClass:"k-drag-status"}))},p=e('<div class="k-grouping-dropclue"/>');function f(e){e.contents().filter((function(){return 3===this.nodeType})).remove()}var h=r.extend({init:function(t,a){var s,l,h=this,m=n.guid(),_=h._intializePositions.bind(h);h._dropCuePositions=[];r.fn.init.call(h,t,a),d=n.support.isRtl(t),l=d?"right":"left",h.draggable=s=h.options.draggable||new n.ui.Draggable(h.element,{filter:h.options.draggableElements,hint:u,group:m}),h.groupContainer=e(h.options.groupContainer,h.element).kendoDropTarget({group:s.options.group,dragenter:function(e){h._canDrag(e.draggable.currentTarget)&&(n.ui.icon(e.draggable.hint.find(".k-drag-status"),{icon:"plus"}),p.css(l,0).appendTo(h.groupContainer))},dragleave:function(e){n.ui.icon(e.draggable.hint.find(".k-drag-status"),{icon:"cancel"}),p.remove()},drop:function(t){var r,i=t.draggable.currentTarget,a=i.attr(n.attr("field")),s=i.attr(n.attr("title")),l=i.attr("id"),g=h.indicator(a),u=h._dropCuePositions,m=u[u.length-1],_="after",v=d||!m?0:m.element.parent().position().left,b=o({},h.options.sort,i.data(c)),C=b.dir;(i.hasClass("k-chip")||h._canDrag(i))&&(m?(r=h._dropCuePosition(n.getOffset(p).left+v+parseInt(m.element.css("marginLeft"),10)*(d?-1:1)+parseInt(m.element.css("marginRight"),10)))&&h._canDrop(e(g),r.element,r.left)&&(r.before&&(_="before"),r.element[_](g||h.buildIndicator(a,s,C,l).wrapper),h._setIndicatorSortOptions(a,b),h._change()):(f(h._messageContainer),h._list.element.show(),h._list.add(h.buildIndicator(a,s,C,l).element),h._setIndicatorSortOptions(a,b),h._change()))}}).kendoDraggable({filter:"div.k-chip",hint:u,group:s.options.group,dragcancel:h._dragCancel.bind(h),dragstart:function(e){var t=e.currentTarget,r=parseInt(t.css("marginLeft"),10),a=t.position(),o=d?a.left-r:a.left+i(t);_(),p.css("left",o).appendTo(h.groupContainer),n.ui.icon(this.hint.find(".k-drag-status"),{icon:"plus"})},dragend:function(){h._dragEnd(this)},drag:h._drag.bind(h)}),s.bind(["dragend","dragcancel","dragstart","drag"],{dragend:function(){h._dragEnd(this)},dragcancel:h._dragCancel.bind(h),dragstart:function(e){h.options.allowDrag||h._canDrag(e.currentTarget)?_():e.preventDefault()},drag:h._drag.bind(h)}),h.dataSource=h.options.dataSource,h._messageContainer=h.groupContainer.find("."+g),h._messageContainer.length||(h._messageContainer=e("<div/>").addClass(g).appendTo(h.groupContainer)),h._createList(),h.dataSource&&h._refreshHandler?h.dataSource.unbind("change",h._refreshHandler):h._refreshHandler=h.refresh.bind(h),h.dataSource&&(h.dataSource.bind("change",h._refreshHandler),h.refresh())},refresh:function(){var t=this,n=t.dataSource.group()||[],r=a("field"),i=a("title");t.groupContainer&&(t._list&&(t._list.remove(t._list.items()),t._list.element.hide()),n.length&&f(t._messageContainer),s(n,(function(n,a){var s=a.field,d=a.dir,l=t.element.find(t.options.filter).filter((function(){return e(this).attr(r)===s})),c=t.buildIndicator(s,l.attr(i),d,l.attr("id"));t._list.add(c.element),t._list.element.show(),t._setIndicatorSortOptions(s,o({},t.options.sort,{dir:d,compare:a.compare}))}))),t._invalidateGroupContainer()},destroy:function(){var e=this;r.fn.destroy.call(e),e.groupContainer.off(".kendoGroupable"),e.groupContainer.data("kendoDropTarget")&&e.groupContainer.data("kendoDropTarget").destroy(),e.groupContainer.data("kendoDraggable")&&e.groupContainer.data("kendoDraggable").destroy(),e.options.draggable||e.draggable.destroy(),e.dataSource&&e._refreshHandler&&(e.dataSource.unbind("change",e._refreshHandler),e._refreshHandler=null),e._list&&e._list.destroy(),e.groupContainer=e.element=e.draggable=null},events:["change","removeGroup"],options:{name:"Groupable",filter:"th",draggableElements:"th",messages:{empty:"Drag a column header and drop it here to group by that column"},sort:{dir:l,compare:null},enableContextMenu:!1},indicator:function(t){var r=e(".k-chip",this.groupContainer);return e.grep(r,(function(r){return e(r).attr(n.attr("field"))===t}))[0]},removeHandler:function(e){this._removeIndicator(e.sender.wrapper)},clickHandler:function(t){var n=t.sender.wrapper.find(".k-chip-icon"),r=n.attr(a("dir"))===l?"desc":l;e(t.originalEvent.target).closest(".k-groupable-context-menu").length||(n.attr(a("dir"),r),this._change())},buildIndicator:function(t,r,i,a){var o,s,d,c=this;return i=i||(c.options.sort||{}).dir||l,s=(d=(o=e("<div/>").kendoChip({icon:"sort-"+("asc"==(i||"asc")?"asc-small":"desc-small"),iconClass:"k-chip-icon",label:`${n.htmlEncode(r||t)}`,removable:!0,size:c.options.size||"medium",remove:c.removeHandler.bind(c),click:c.clickHandler.bind(c),actions:c.options.enableContextMenu?[{icon:"more-vertical",iconClass:"k-groupable-context-menu"}]:null}).data("kendoChip")).wrapper).find(".k-chip-icon").first(),d.attr(`data-${n.ns}field`,t),d.attr(`data-${n.ns}title`,r||""),a&&d.attr(`data-${n.ns}id`,a),s.attr("title",`(sorted ${"asc"==i?"ascending":"descending"})`),s.attr(`data-${n.ns}dir`,i),o},_setIndicatorSortOptions:function(t,n){e(this.indicator(t)).data(c,n)},aggregates:function(){var t,r,i;return this.element.find(this.options.filter).map((function(){var a=e(this),o=a.attr(n.attr("aggregates")),s=a.attr(n.attr("field"));if(o&&""!==o)for(t=o.split(","),o=[],r=0,i=t.length;r<i;r++)o.push({field:s,aggregate:t[r]});return o})).toArray()},descriptors:function(){var t,r=this,i=e(".k-chip",r.groupContainer),a=r.aggregates();return e.map(i,(function(i){i=e(i),t=i.attr(n.attr("field"));var o=r.options.sort||{},s=i.data(c)||{},d=i.find(".k-chip-icon");return{field:t,dir:d.attr(n.attr("dir")),aggregates:a||[],colID:i.attr(n.attr("id")),compare:s.compare||o.compare}}))},_removeIndicator:function(e){var t=this;t.trigger("removeGroup",{field:e.attr(n.attr("field")),colID:e.attr(n.attr("id"))}),t._list.remove(e),e.off(),e.removeData(),t._invalidateGroupContainer(),t._change()},_change:function(){var e=this;if(e.dataSource){var t=e.descriptors();if(e.trigger("change",{groups:t}))return void e.refresh();e.dataSource.group(t)}},_dropCuePosition:function(t){var n=this._dropCuePositions;if(p.is(":visible")&&0!==n.length){t=Math.ceil(t);var r=n[n.length-1],a=r.left,o=r.right,s=parseInt(r.element.css("marginLeft"),10),l=parseInt(r.element.css("marginRight"),10),c=r.element.parent().position().left-parseInt(this.groupContainer.css("paddingLeft"),10);return t>=o&&!d||t<a&&d?t={left:r.element.position().left+(d?c-s:i(r.element)+l),element:r.element,before:!1}:(t=e.grep(n,(function(e){return e.left<=t&&t<=e.right||d&&t>e.right}))[0])&&(t={left:d?t.element.position().left+i(t.element)+l+c:t.element.position().left-s,element:t.element,before:!0}),t}},_drag:function(e){var t=this._dropCuePosition(e.x.location);t&&p.css({left:t.left,right:"auto"})},_canDrag:function(e){var t=e.attr(n.attr("field"));return"false"!=e.attr(n.attr("groupable"))&&t&&(e.hasClass("k-chip")||!this.indicator(t))},_canDrop:function(e,t,n){var r=e.next();return e[0]!==t[0]&&(!r[0]||t[0]!==r[0]||!d&&n>r.position().left||d&&n<r.position().left)},_dragEnd:function(t){var r=this,i=t.currentTarget.attr(n.attr("field")),a=r.indicator(i);t!==r.options.draggable&&!t.dropped&&a&&r._removeIndicator(e(a)),r._dragCancel()},_dragCancel:function(){p.remove(),this._dropCuePositions=[]},_intializePositions:function(){var t,r=e(".k-chip",this.groupContainer);this._dropCuePositions=e.map(r,(function(r){return r=e(r),t=n.getOffset(r).left,{left:parseInt(t,10),right:parseInt(t+i(r),10),element:r}}))},_invalidateGroupContainer:function(){var e=this.groupContainer,t=this._list;e&&t&&t.element.is(":empty")&&this._messageContainer.text(this.options.messages.empty)},_createList:function(){var t=this;t.groupContainer.find(".k-chip-list").remove(),t._list=e("<div/>").kendoChipList({selectable:"none",size:t.options.size||"medium"}).data("kendoChipList"),t._list.element.insertBefore(t._messageContainer)}});n.ui.plugin(h)}(window.kendo.jQuery),kendo}));
//# sourceMappingURL=kendo.groupable.min.js.map
